name: Scheduled Bollinger Alert

on:
  schedule:
    # This runs the job every 5 minutes (UTC)
    #- cron: '*/5 * * * *' 
  # Allows you to manually trigger a run from the "Actions" tab in GitHub
  #workflow_dispatch:

jobs:
  run-python-script:
    # Uses a standard Ubuntu runner environment
    runs-on: ubuntu-latest
    
    steps:
      # Step 1: Check out your repository code
      - name: Checkout repository
        uses: actions/checkout@v4

      # Step 2: Set up the Python environment
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          # IMPORTANT: Change this to your required Python version (e.g., '3.8', '3.11')
          python-version: '3.10' 

      # Step 3: Install the project dependencies (requires requirements.txt)
      - name: Install dependencies
        run: pip install -r requirements.txt

      # Step 4: Run your main script file and inject secrets
      - name: Execute Alert Script
        # IMPORTANT: Replace 'alert_scheduler.py' if your file is named differently or in a subdirectory
        run: python alert_scheduler.py 
        env:
          # These names MUST match the Secret Names you created in GitHub Settings
          TWELVE_API_KEY: ${{ secrets.TWELVE_API_KEY }} 
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
